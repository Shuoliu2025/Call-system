# 🚗 自动叫号系统

一个完整的车辆预约和叫号管理系统，支持在线预约、实时叫号显示和历史记录管理。

## ✨ 功能特点

- **📋 预约管理**: 用户可在线填写姓名、手机号、车牌号进行预约
- **🕒 定时控制**: 每日8:30自动开始叫号显示
- **📺 实时显示**: 同时显示4条预约信息，实时更新
- **✅ 出库管理**: 点击出库后自动移除并补充下一条预约
- **💾 数据存储**: 自动保存每日预约记录和出库历史
- **📊 历史统计**: 查看当日预约、出库和等待统计
- **🔄 实时同步**: 使用WebSocket实现多端实时数据同步

## 🛠️ 技术栈

- **后端**: Node.js + Express + Socket.io
- **前端**: HTML5 + CSS3 + JavaScript
- **数据存储**: JSON文件存储
- **定时任务**: node-cron
- **实时通信**: WebSocket

## 🚀 快速开始

### 安装依赖
```bash
npm install
```

### 启动服务
```bash
# 生产环境
npm start

# 开发环境（自动重启）
npm run dev
```

### 访问系统
- 系统地址: http://localhost:3000
- 预约页面: http://localhost:3000/index.html
- 叫号显示: http://localhost:3000/display.html
- 历史记录: http://localhost:3000/history.html

## 📖 使用说明

### 1. 预约登记
- 打开预约页面填写车辆信息
- 必填: 姓名、手机号、车牌号
- 可选: 勾选"出库车辆"（直接出库，不进入叫号队列）

### 2. 叫号显示
- 系统每日8:30开始显示叫号信息
- 同时显示4辆车的详细信息
- 按预约时间顺序自动排序
- 支持手动刷新和自动刷新

### 3. 出库操作
- 点击"出库完成"按钮确认车辆出库
- 出库后自动从显示列表移除
- 下一辆车自动补充到显示列表

### 4. 历史记录
- 查看当日所有预约和出库记录
- 显示详细的时间统计信息
- 支持数据刷新和导出

## 📂 项目结构

```
call-system/
├── server.js          # 服务器主文件
├── package.json       # 项目配置
├── public/            # 前端静态文件
│   ├── index.html     # 预约页面
│   ├── display.html   # 叫号显示页面
│   ├── history.html   # 历史记录页面
│   ├── styles.css     # 样式文件
│   └── app.js         # 前端逻辑
└── data/             # 数据存储目录（自动创建）
    ├── appointments_YYYY-MM-DD.json  # 每日预约数据
    └── history_YYYY-MM-DD.json       # 每日历史记录
```

## 🔧 API接口

### POST /api/appointments
创建新预约
```json
{
  "name": "张三",
  "phone": "13812345678",
  "licensePlate": "京A12345",
  "isOutbound": false
}
```

### GET /api/appointments
获取当前预约列表

### POST /api/outbound/:id
标记车辆出库

### GET /api/history
获取当日历史记录

## ⏰ 系统时间控制

- **工作时间**: 8:30 - 18:00
- **叫号开始**: 每日8:30自动开始显示
- **数据保存**: 每日0点自动保存并清空当日数据
- **状态更新**: 每分钟检查系统状态

## 🎯 核心特性

### 实时同步
- 使用WebSocket实现多端数据同步
- 预约、出库操作实时更新到所有客户端

### 数据安全
- 自动备份每日数据
- 错误恢复和数据校验
- 防止重复提交

### 用户体验
- 响应式设计，支持移动端
- 直观的操作界面
- 实时状态提示和错误提醒

## 🔒 注意事项

1. **端口配置**: 默认端口3000，可通过环境变量PORT修改
2. **数据备份**: 建议定期备份data目录
3. **网络要求**: 需要稳定的网络连接支持WebSocket
4. **浏览器兼容**: 建议使用Chrome、Firefox等现代浏览器

## 🐛 故障排除

### 服务启动失败
- 检查端口3000是否被占用
- 确认Node.js版本 >= 14

### 数据不同步
- 检查WebSocket连接状态
- 刷新页面重新连接

### 预约提交失败
- 检查网络连接
- 验证输入数据格式

## 📞 技术支持

如有问题或建议，请联系系统管理员。

---

**版本**: v1.0.0
**最后更新**: 2024年11月
**开发者**: Claude Code Assistant